- id: join
  name: join
  description: Copy multiple files into a single directory
  path: cp
  runtime: other

  parameters:
    - id: no_overwrite
      name: No overwrite
      description: Do not overwrite existing files
      type: argument
      cardinality: 1..1
      label: -n
      data_type: boolean
      default: false

    - id: input_file
      name: Input file name
      description: Input file name
      type: input
      cardinality: 1..n
      data_type: file

    - id: output_directory
      name: Output directory
      description: Output directory
      type: output
      cardinality: 1..1
      data_type: directory

- id: mProjExec
  name: mProjExec
  description: A simple executive which runs mProject for each image in an image metadata table
  path: mProjExec
  runtime: other

  parameters:
    - id: useQL
      name: mProjectQL
      description: Use mProjectQL for reprojections
      type: argument
      cardinality: 1..1
      label: -q
      data_type: boolean

    - id: rawdir
      name: Raw directory
      description: Specifies the path to the directory containing the images to be reprojected
      type: input
      cardinality: 1..1
      label: -p
      data_type: directory

    - id: images_table
      name: Images table
      description: ASCII table (generated by mImgtbl) containing metadata for all images to be reprojected
      type: input
      cardinality: 1..1
      data_type: file

    - id: header_template
      name: Header template
      description: FITS header template to be used in generation of output FITS
      type: input
      cardinality: 1..1
      data_type: file

    - id: output_directory
      name: Output directory
      description: Directory in which to create reprojected images
      type: output
      cardinality: 1..1
      data_type: directory

    - id: stats_table
      name: Stats table
      description: Name of table for output statistics
      type: output
      cardinality: 1..1
      data_type: file
      file_suffix: .tbl

- id: mProjectPP
  name: mProjectPP
  description: Reprojects a single image to the scale defined in a pseudo-FITS header template file
  path: mProjectPP
  runtime: other

  parameters:
    - id: input_image
      name: Input image
      description: Input FITS file to be reprojected
      type: input
      cardinality: 1..1
      data_type: file

    - id: output_image
      name: Output image
      description: Path of output FITS file to be created
      type: output
      cardinality: 1..1
      data_type: file
      file_suffix: .fits

    - id: header_template
      name: Header template
      description: FITS header template to be used in generation of output FITS
      type: input
      cardinality: 1..1
      data_type: file

- id: mImgtbl
  name: mImgtbl
  description: Extracts the FITS header information from a set of files and creates an ASCII image metadata table which can be used by several of the other programs
  path: mImgtbl
  runtime: other

  parameters:
    - id: directory
      name: Input directory
      description: Path to directory containing set of input FITS files
      type: input
      cardinality: 1..1
      data_type: directory

    - id: output_table
      name: Output table
      description: Path of output metadata table
      type: output
      cardinality: 1..1
      data_type: file
      file_suffix: .tbl

- id: mOverlaps
  name: mOverlaps
  description: Analyze an image metadata table to determine a list of overlapping images
  path: mOverlaps
  runtime: other

  parameters:
    - id: image_table
      name: Image table
      description: Table of image metadata generated by mImgtbl
      type: input
      cardinality: 1..1
      data_type: file

    - id: output_table
      name: Output table
      description: Path of output table to be generated containing overlap information
      type: output
      cardinality: 1..1
      data_type: file
      file_suffix: .tbl

- id: splitOverlapTable
  name: splitOverlapTable
  description: Splits an overlap table into multiple overlap pairs (one output file per row)
  path: splitOverlapTable.js
  runtime: other

  parameters:
    - id: overlap_table
      name: Overlap table
      description: The overlap table to split
      type: input
      cardinality: 1..1
      data_type: file

    - id: output_directory
      name: Output directory
      description: A directory in which to create the output files
      type: output
      cardinality: 1..1
      data_type: directory

- id: mDiffFit
  name: mDiffFit
  description: Runs both mDiff and mFitplane on an mOverlaps pair
  path: mDiffFitWrapper
  runtime: other

  parameters:
    - id: projected_images
      name: Projected images directory
      description: Directory containing projected images
      type: input
      cardinality: 1..1
      label: -p
      data_type: directory

    - id: overlap_table
      name: Overlap table
      description: The overlap table generated by splitOverlapTable
      type: input
      cardinality: 1..1
      label: -i
      data_type: file

    - id: output_stats
      name: Output stats file
      description: Output stats file
      type: output
      cardinality: 1..1
      label: -s
      data_type: file
      file_suffix: .txt

    - id: output_image
      name: Output image
      description: Output image
      type: output
      cardinality: 1..1
      label: -o
      data_type: file
      file_suffix: .fits

    - id: header_template
      name: Header template
      description: FITS header template that was used to reproject the images
      type: input
      cardinality: 1..1
      label: -t
      data_type: file

- id: mDiffFitExec
  name: mDiffFitExec
  description: Runs both mDiff and mFitplane on all the mOverlaps pairs. Creates a table of image-to-image difference parameters.
  path: mDiffFitExec
  runtime: other

  parameters:
    - id: projected_images
      name: Projected images directory
      description: Directory containing projected images
      type: input
      cardinality: 1..1
      label: -p
      data_type: directory

    - id: overlap_table
      name: Overlap table
      description: Overlap table generated by mOverlaps, listing all the image pairs that overlap
      type: input
      cardinality: 1..1
      data_type: file

    - id: header_template
      name: Header template
      description: FITS header template that was used to reproject the images
      type: input
      cardinality: 1..1
      data_type: file

    - id: working_directory
      name: Working directory
      description: Working directory for the difference images
      type: output
      cardinality: 1..1
      data_type: directory

    - id: output_table
      name: Plane fitting table
      description: Output table of difference parameters.
      type: output
      cardinality: 1..1
      data_type: file
      file_suffix: .tbl

- id: mConcatFit
  name: mConcatFit
  description: >-
    Parses the stats files created by multiple calls to mDiffFitWrapper and
    concats them to a table that can be used by the subsequent Montage processes
  path: mConcatFit.js
  runtime: other

  parameters:
    - id: input_file
      name: Input file
      description: Input file(s) to concatenate
      type: input
      cardinality: 1..n
      data_type: file

    - id: output_file
      name: Output file
      description: Output table
      type: output
      cardinality: 1..1
      data_type: file
      file_suffix: .tbl

- id: mBgModel
  name: mBgModel
  description: >-
    Modelling/fitting program which uses the image-to-image difference parameter
    table to interactively determine a set of corrections to apply to each
    image to achieve a "best" global fit
  path: mBgModel
  runtime: other

  parameters:
    - id: image_table
      name: Image table
      description: Table of image metadata generated by mImgtbl
      type: input
      cardinality: 1..1
      data_type: file

    - id: fitting_table
      name: Plane fitting table
      description: Plane fitting table generated by mFitExec
      type: input
      cardinality: 1..1
      data_type: file

    - id: output_table
      name: Output table
      description: Output table of background corrections
      type: output
      cardinality: 1..1
      data_type: file
      file_suffix: .tbl

- id: mBgExec
  name: mBgExec
  description: Run mBackground on all the images in the metadata table
  path: mBgExec
  runtime: other

  parameters:
    - id: projected_images
      name: Projected images directory
      description: Directory containing projected images
      type: input
      cardinality: 1..1
      label: -p
      data_type: directory

    - id: image_table
      name: Image table
      description: Table of image metadata generated by mImgtbl
      type: input
      cardinality: 1..1
      data_type: file

    - id: corrections_table
      name: Corrections table
      description: Table of corrections generated by mFitExec
      type: input
      cardinality: 1..1
      data_type: file

    - id: output_directory
      name: Output directory
      description: Directory where output images should be written
      type: output
      cardinality: 1..1
      data_type: directory

- id: mBackground
  name: mBackground
  description: Remove a background from a single image
  path: mBackground
  runtime: other

  parameters:
    - id: table_mode
      name: Table mode
      description: true if command line contains tables instead of plain correction values
      type: argument
      cardinality: 1..1
      label: -t
      data_type: boolean
      default: true

    - id: input_image
      name: Input image
      description: Input FITS file
      type: input
      cardinality: 1..1
      data_type: file

    - id: output_image
      name: Output image
      description: Output FITS file
      type: output
      cardinality: 1..1
      data_type: file
      file_suffix: .fits

    - id: image_table
      name: Image table
      description: Table of image metadata generated by mImgtbl
      type: input
      cardinality: 1..1
      data_type: file

    - id: corrections_table
      name: Corrections table
      description: Table of corrections generated by mFitExec
      type: input
      cardinality: 1..1
      data_type: file

- id: mAdd
  name: mAdd
  description: >-
    Coadd the reprojected images using the same FITS header template and
    working from the same mImgtbl list as was used to reproject the image set
  path: mAdd
  runtime: other

  parameters:
    - id: reprojected_images
      name: Reprojected images directory
      description: Specifies path to directory containing reprojected images
      type: input
      cardinality: 1..1
      label: -p
      data_type: directory

    - id: image_table
      name: Image table
      description: >-
        ASCII table (generated by mImgtbl) containing metadata for all images
        to be coadded
      type: input
      cardinality: 1..1
      data_type: file

    - id: header_template
      name: Header template
      description: FITS header template that was used to reproject the images
      type: input
      cardinality: 1..1
      data_type: file

    - id: output_image
      name: Output image
      description: Name of output FITS image
      type: output
      cardinality: 1..1
      data_type: file
      file_suffix: .fits

- id: mShrink
  name: mShrink
  description: Changes the binning of a FITS image
  path: mShrink
  runtime: other

  parameters:
    - id: input_image
      name: Input image
      description: Input FITS file
      type: input
      cardinality: 1..1
      data_type: file

    - id: output_image
      name: Output image
      description: Path to output FITS file
      type: output
      cardinality: 1..1
      data_type: file
      file_suffix: .fits

    - id: factor
      name: Reduction factor
      description: >-
        Size of blocks, in pixels, to average. File size will be reduced
        by 1/factor squared
      type: argument
      cardinality: 1..1
      data_type: number

- id: mViewerGray
  name: mViewer Grayscale
  description: Create a JPEG image from one or more input FITS images
  path: mViewer
  runtime: other

  parameters:
    - id: color_table
      name: Color table
      description: Color table ID
      type: argument
      cardinality: 1..1
      label: -ct
      data_type: number
      default: 0

    - id: input_image
      name: Input image
      description: Input FITS image to convert to JPEG
      type: input
      cardinality: 1..1
      label: -gray
      data_type: file

    - id: min
      name: Stretch minimum
      description: Stretch minimum
      type: argument
      cardinality: 1..1
      data_type: string
      default: -2s

    - id: max
      name: Stretch maximum
      description: Stretch maximum
      type: argument
      cardinality: 1..1
      data_type: string
      default: max

    - id: mode
      name: Stretch mode
      description: Stretch mode
      type: argument
      cardinality: 1..1
      data_type: string
      default: gaussian-log

    - id: output_image
      name: Output image
      description: Output image
      type: output
      cardinality: 1..1
      label: -out
      data_type: file
      file_suffix: .jpg
