- id: mHdr
  name: mHdr
  description: Create a FITS header template from user-supplied parameters
  path: mHdr
  runtime: other

  parameters:
    - id: location
      name: Location
      description: Object string or coordinate location
      type: input
      cardinality: 1..1
      dataType: string

    - id: width
      name: Width
      description: Width (x-axis) of area in degrees
      type: input
      cardinality: 1..1
      dataType: string

    - id: output_file
      name: Output file
      description: Path to output header template
      type: output
      cardinality: 1..1
      dataType: file
      fileSuffix: .hdr

- id: mProjExec
  name: mProjExec
  description: A simple executive which runs mProject for each image in an image metadata table
  path: mProjExec
  runtime: other

  parameters:
    - id: useQL
      name: mProjectQL
      description: Use mProjectQL for reprojections
      type: input
      cardinality: 1..1
      label: -q
      dataType: boolean

    - id: rawdir
      name: Raw directory
      description: Specifies the path to the directory containing the images to be reprojected
      type: input
      cardinality: 1..1
      label: -p
      dataType: directory

    - id: images_table
      name: Images table
      description: ASCII table (generated by mImgtbl) containing metadata for all images to be reprojected
      type: input
      cardinality: 1..1
      dataType: file

    - id: header_template
      name: Header template
      description: FITS header template to be used in generation of output FITS
      type: input
      cardinality: 1..1
      dataType: file

    - id: output_directory
      name: Output directory
      description: Directory in which to create reprojected images
      type: output
      cardinality: 1..1
      dataType: file

    - id: stats_table
      name: Stats table
      description: Name of table for output statistics
      type: output
      cardinality: 1..1
      dataType: file
      fileSuffix: .tbl

- id: mProjectPP
  name: mProjectPP
  description: Reprojects a single image to the scale defined in a pseudo-FITS header template file
  path: mProjectPP
  runtime: ignoreError

  parameters:
    - id: input_image
      name: Input image
      description: Input FITS file to be reprojected
      type: input
      cardinality: 1..1
      dataType: file

    - id: output_image
      name: Output image
      description: Path of output FITS file to be created
      type: output
      cardinality: 1..1
      dataType: fileOrEmptyList
      fileSuffix: .fits

    - id: header_template
      name: Header template
      description: FITS header template to be used in generation of output FITS
      type: input
      cardinality: 1..1
      dataType: file

- id: mImgtbl
  name: mImgtbl
  description: Extracts the FITS header information from a set of files and creates an ASCII image metadata table which can be used by several of the other programs
  path: mImgtbl
  runtime: other

  parameters:
    - id: directory
      name: Input directory
      description: Path to directory containing set of input FITS files
      type: input
      cardinality: 1..1
      dataType: directory

    - id: output_table
      name: Output table
      description: Path of output metadata table
      type: output
      cardinality: 1..1
      dataType: file
      fileSuffix: .tbl

- id: mOverlaps
  name: mOverlaps
  description: Analyze an image metadata table to determine a list of overlapping images
  path: mOverlaps
  runtime: other

  parameters:
    - id: image_table
      name: Image table
      description: Table of image metadata generated by mImgtbl
      type: input
      cardinality: 1..1
      dataType: file

    - id: output_table
      name: Output table
      description: Path of output table to be generated containing overlap information
      type: output
      cardinality: 1..1
      dataType: overlapTable
      fileSuffix: .tbl

- id: mOverlapsSeq
  name: mOverlapsSeq
  description: Analyze an image metadata table to determine a list of overlapping images
  path: mOverlaps
  runtime: other

  parameters:
    - id: image_table
      name: Image table
      description: Table of image metadata generated by mImgtbl
      type: input
      cardinality: 1..1
      dataType: file

    - id: output_table
      name: Output table
      description: Path of output table to be generated containing overlap information
      type: output
      cardinality: 1..1
      dataType: file
      fileSuffix: .tbl

- id: mDiffFit
  name: mDiffFit
  description: Runs both mDiff and mFitplane on an mOverlaps pair
  path: mDiffFit
  runtime: ignoreError

  parameters:
    - id: output_stats
      name: Output stats file
      description: Output stats file
      type: output
      cardinality: 1..1
      label: -s
      dataType: file
      fileSuffix: .txt

    - id: input_image
      name: Input image
      description: The images to compare
      type: input
      cardinality: 1..2
      dataType: file

    - id: output_image
      name: Output image
      description: Output image
      type: output
      cardinality: 1..1
      dataType: diffFit
      fileSuffix: .fits

    - id: header_template
      name: Header template
      description: FITS header template that was used to reproject the images
      type: input
      cardinality: 1..1
      dataType: file

- id: mDiffFitExec
  name: mDiffFitExec
  description: Runs both mDiff and mFitplane on all the mOverlaps pairs. Creates a table of image-to-image difference parameters.
  path: mDiffFitExec
  runtime: other

  parameters:
    - id: projected_images
      name: Projected images directory
      description: Directory containing projected images
      type: input
      cardinality: 1..1
      label: -p
      dataType: directory

    - id: overlap_table
      name: Overlap table
      description: Overlap table generated by mOverlaps, listing all the image pairs that overlap
      type: input
      cardinality: 1..1
      dataType: file

    - id: header_template
      name: Header template
      description: FITS header template that was used to reproject the images
      type: input
      cardinality: 1..1
      dataType: file

    - id: working_directory
      name: Working directory
      description: Working directory for the difference images
      type: output
      cardinality: 1..1
      dataType: directory

    - id: output_table
      name: Plane fitting table
      description: Output table of difference parameters.
      type: output
      cardinality: 1..1
      dataType: file
      fileSuffix: .tbl

- id: joinDiffFitResults
  name: joinDiffFitResults
  description: >-
    Joins results of the createDiffFitInfo output adapter to a file that can
    be read by mConcatFit
  path: echo
  runtime: other

  parameters:
    - id: input_directory
      name: Input directory
      description: A directory with .fits files created by the createDiffFitInfo output adapter
      type: input
      cardinality: 1..1
      dataType: directory

    - id: image_table
      name: Image table
      description: Table of image metadata generated by mImgtbl
      type: input
      cardinality: 1..1
      dataType: file

    - id: output_file
      name: Output file
      description: Output file containing the joined results
      type: output
      cardinality: 1..1
      dataType: joinedDiffFitResults
      fileSuffix: .tbl

- id: mConcatFit
  name: mConcatFit
  description: Merge multiple plane fit parameter files (from mFitplane) into one file
  path: mConcatFit
  runtime: other

  parameters:
    - id: stat_files_table
      name: Stat files table
      description: Input table containing references to stat files
      type: input
      cardinality: 1..1
      dataType: file

    - id: output_table
      name: Output table
      description: Concatenated results
      type: output
      cardinality: 1..1
      dataType: file
      fileSuffix: .tbl

    - id: stat_dir
      name: Stat dir
      description: Directory containing the stat files
      type: input
      cardinality: 1..1
      dataType: string
      default: ""

- id: mBgModel
  name: mBgModel
  description: >-
    Modelling/fitting program which uses the image-to-image difference parameter
    table to interactively determine a set of corrections to apply to each
    image to achieve a "best" global fit
  path: mBgModel
  runtime: other

  parameters:
    - id: image_table
      name: Image table
      description: Table of image metadata generated by mImgtbl
      type: input
      cardinality: 1..1
      dataType: file

    - id: fitting_table
      name: Plane fitting table
      description: Plane fitting table generated by mFitExec
      type: input
      cardinality: 1..1
      dataType: file

    - id: output_table
      name: Output table
      description: Output table of background corrections
      type: output
      cardinality: 1..1
      dataType: file
      fileSuffix: .tbl

- id: mBgExec
  name: mBgExec
  description: Run mBackground on all the images in the metadata table
  path: mBgExec
  runtime: other

  parameters:
    - id: projected_images
      name: Projected images directory
      description: Directory containing projected images
      type: input
      cardinality: 1..1
      label: -p
      dataType: directory

    - id: image_table
      name: Image table
      description: Table of image metadata generated by mImgtbl
      type: input
      cardinality: 1..1
      dataType: file

    - id: corrections_table
      name: Corrections table
      description: Table of corrections generated by mFitExec
      type: input
      cardinality: 1..1
      dataType: file

    - id: output_directory
      name: Output directory
      description: Directory where output images should be written
      type: output
      cardinality: 1..1
      dataType: directory

- id: mBackground
  name: mBackground
  description: Remove a background from a single image
  path: mBackground
  runtime: other

  parameters:
    - id: table_mode
      name: Table mode
      description: true if command line contains tables instead of plain correction values
      type: input
      cardinality: 1..1
      label: -t
      dataType: boolean
      default: true

    - id: input_image
      name: Input image
      description: Input FITS file
      type: input
      cardinality: 1..1
      dataType: file

    - id: output_image
      name: Output image
      description: Output FITS file
      type: output
      cardinality: 1..1
      dataType: fits
      fileSuffix: .fits

    - id: image_table
      name: Image table
      description: Table of image metadata generated by mImgtbl
      type: input
      cardinality: 1..1
      dataType: file

    - id: corrections_table
      name: Corrections table
      description: Table of corrections generated by mFitExec
      type: input
      cardinality: 1..1
      dataType: file

- id: mAdd
  name: mAdd
  description: >-
    Coadd the reprojected images using the same FITS header template and
    working from the same mImgtbl list as was used to reproject the image set
  path: mAdd
  runtime: other

  parameters:
    - id: reprojected_images
      name: Reprojected images directory
      description: Specifies path to directory containing reprojected images
      type: input
      cardinality: 1..1
      label: -p
      dataType: directory

    - id: image_table
      name: Image table
      description: >-
        ASCII table (generated by mImgtbl) containing metadata for all images
        to be coadded
      type: input
      cardinality: 1..1
      dataType: file

    - id: header_template
      name: Header template
      description: FITS header template that was used to reproject the images
      type: input
      cardinality: 1..1
      dataType: file

    - id: output_image
      name: Output image
      description: Name of output FITS image
      type: output
      cardinality: 1..1
      dataType: file
      fileSuffix: .fits

- id: mShrink
  name: mShrink
  description: Changes the binning of a FITS image
  path: mShrink
  runtime: other

  parameters:
    - id: input_image
      name: Input image
      description: Input FITS file
      type: input
      cardinality: 1..1
      dataType: file

    - id: output_image
      name: Output image
      description: Path to output FITS file
      type: output
      cardinality: 1..1
      dataType: file
      fileSuffix: .fits

    - id: factor
      name: Reduction factor
      description: >-
        Size of blocks, in pixels, to average. File size will be reduced
        by 1/factor squared
      type: input
      cardinality: 1..1
      dataType: number

- id: mViewerGray
  name: mViewer Grayscale
  description: Create a JPEG image from one or more input FITS images
  path: mViewer
  runtime: other

  parameters:
    - id: color_table
      name: Color table
      description: Color table ID
      type: input
      cardinality: 1..1
      label: -ct
      dataType: number
      default: 0

    - id: input_image
      name: Input image
      description: Input FITS image to convert to JPEG
      type: input
      cardinality: 1..1
      label: -gray
      dataType: file

    - id: min
      name: Stretch minimum
      description: Stretch minimum
      type: input
      cardinality: 1..1
      dataType: string
      default: -2s

    - id: max
      name: Stretch maximum
      description: Stretch maximum
      type: input
      cardinality: 1..1
      dataType: string
      default: max

    - id: mode
      name: Stretch mode
      description: Stretch mode
      type: input
      cardinality: 1..1
      dataType: string
      default: gaussian-log

    - id: output_image
      name: Output image
      description: Output image
      type: output
      cardinality: 1..1
      label: -out
      dataType: file
      fileSuffix: .jpg

- id: mViewer
  name: mViewer RGB
  description: Create a JPEG image from one or more input FITS images
  path: mViewer
  runtime: other

  parameters:
    - id: true_color
      name: True color
      description: Enables true color
      type: input
      cardinality: 1..1
      label: -t
      dataType: number
      default: 2

    - id: red_input_image
      name: Red input image
      description: Red input FITS image to convert to JPEG
      type: input
      cardinality: 1..1
      label: -red
      dataType: file

    - id: r_min
      name: R Stretch minimum
      description: Stretch minimum for the R channel
      type: input
      cardinality: 1..1
      dataType: string
      default: 0s

    - id: r_max
      name: R Stretch maximum
      description: Stretch maximum for the R channel
      type: input
      cardinality: 1..1
      dataType: string
      default: max

    - id: r_mode
      name: R Stretch mode
      description: Stretch mode for the R channel
      type: input
      cardinality: 1..1
      dataType: string
      default: gaussian-log

    - id: green_input_image
      name: Green input image
      description: Red input FITS image to convert to JPEG
      type: input
      cardinality: 1..1
      label: -green
      dataType: file

    - id: g_min
      name: G Stretch minimum
      description: Stretch minimum for the G channel
      type: input
      cardinality: 1..1
      dataType: string
      default: 0s

    - id: g_max
      name: G Stretch maximum
      description: Stretch maximum for the G channel
      type: input
      cardinality: 1..1
      dataType: string
      default: max

    - id: g_mode
      name: G Stretch mode
      description: Stretch mode for the G channel
      type: input
      cardinality: 1..1
      dataType: string
      default: gaussian-log

    - id: blue_input_image
      name: Blue input image
      description: Blue input FITS image to convert to JPEG
      type: input
      cardinality: 1..1
      label: -blue
      dataType: file

    - id: b_min
      name: B Stretch minimum
      description: Stretch minimum for the B channel
      type: input
      cardinality: 1..1
      dataType: string
      default: 0s

    - id: b_max
      name: B Stretch maximum
      description: Stretch maximum for the B channel
      type: input
      cardinality: 1..1
      dataType: string
      default: max

    - id: b_mode
      name: B Stretch mode
      description: Stretch mode for the B channel
      type: input
      cardinality: 1..1
      dataType: string
      default: gaussian-log

    - id: output_image
      name: Output image
      description: Output image
      type: output
      cardinality: 1..1
      label: -out
      dataType: file
      fileSuffix: .jpg

- id: download_band
  name: Download band
  description: Download the raw images of a single band
  path: /download/scripts/download_band.sh
  runtime: other

  parameters:
    - id: survey
      name: Survey
      description: Can be one of "2mass", "dss", "sdss", "dposs"
      type: input
      cardinality: 1..1
      dataType: string

    - id: band
      name: Band
      description: "Case insensitive - can be one of: j, h, k (2MASS); u, g, r, i, z (SDSS); f, j, n (DPOSS); DSS1, DSS1R, DSS1B, DSS2, DSS2B, DSS2R, DSS2IR (DSS)"
      type: input
      cardinality: 1..1
      dataType: string

    - id: location
      name: Location
      description: Object name or coordinate string to be resolved by NED
      type: input
      cardinality: 1..1
      dataType: string

    - id: width
      name: Width
      description: Width of area of interest, in degrees
      type: input
      cardinality: 1..1
      dataType: string

    - id: height
      name: Height
      description: Height of area of interest, in degrees
      type: input
      cardinality: 1..1
      dataType: string

    - id: header_template
      name: Header template
      description: FITS header template to be used in generation of output FITS
      type: input
      cardinality: 1..1
      dataType: file

    - id: output_directory
      name: Output directory
      description: Directory where the downloaded images should be stored
      type: output
      cardinality: 1..1
      dataType: directory
